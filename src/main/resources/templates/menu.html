<!DOCTYPE html>
<html th:replace="~{layout/admin_layout::adminLayout(~{::title}, ~{}, ~{::script}, ~{::section})}"
      xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Hello World</title>
</head>
<body>
<section class="content">
    <div class="card">
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-lg-9">
                    <form class="form-inline">
                        <label class="sr-only" for="keywords">keywords</label>
                        <div class="input-group input-group-sm mr-sm-2">
                            <input type="text" class="form-control form-control-sm" id="keywords" autocomplete="off"
                                   placeholder="keywords">
                        </div>

                        <button type="button" class="btn btn-primary btn-sm">
                            <i class="fas fa-search"></i> 查询
                        </button>
                    </form>
                </div>
                <div class="col-lg-3">
                    <div class="text-lg-right">
                        <button type="button" class="btn btn-success btn-sm" id="addBtn">
                            <i class="fas fa-plus"></i> 新增
                        </button>
                    </div>
                </div>
            </div>
            <div id="datagrid"></div>
        </div>
    </div>
    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTitle">Modal title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
</section>
<script th:inline="javascript">
    $(function () {
        let $datagrid = $("#datagrid");
        jsGrid.locale("zh-cn");
        $datagrid.jsGrid({
            height: "auto",
            width: "100%",
            // editing: true,
            // inserting:true,
            // filtering: false,
            // sorting: false,
            paging: true,
            autoload: true,
            pageLoading: true,
            pageSize: 15,
            pageIndex: 1,
            controller: {
                loadData: function (filter) {
                    let d = $.Deferred();
                    $.ajax({
                        type: "GET",
                        url: _root + "menu/list",
                        data: filter,
                        dataType: "json"
                    }).done(function (response) {
                        d.resolve(response);
                    });
                    return d.promise();
                }
            },
            // rowRenderer: function(item, itemIndex) {
            //     console.log(item);
            //     console.log(itemIndex);
            // },
            fields: [
                {name: "id", type: "text", width: 20},
                // {name: "submenus", type: "text", width: 50},
                {name: "menuName", type: "text", width: 50},
                {name: "menuCode", type: "text", width: 50},
                {name: "path", type: "text", width: 50},
                {name: "icon", type: "text", width: 60},
                {name: "sort", type: "text", width: 20},
                {name: "remark", type: "text", width: 50},
                {name: "deletedFlag", type: "text", width: 50},
                {name: "createId", type: "text", width: 50},
                {name: "createdTime", type: "text", width: 100},
                // {name: "updateId", type: "text", width: 50},
                // {name: "updatedTime", type: "text", width: 50},
                {
                    type: "control",
                    title: "操作",
                    width: 90,
                    itemTemplate: function (value, time) {
                        return "<div class=\"card-tools\">" +
                            "<a class=\"btn btn-xs btn-tool text-info control-modify\"><i class=\"fas fa-edit\"></i> 编辑</a>" +
                            "<a class=\"btn btn-xs btn-tool text-danger control-remove\"><i class=\"fas fa-trash\"></i> 删除</a>" +
                            "</div>";
                    }
                }
            ],
            onPageChanged: function (args) {
                console.log(args);
            }
        });
        $datagrid.on("click", ".control-modify", function () {
            toggleEditModal("show", $(this).html());
        });
        $datagrid.on("click", ".control-remove", function () {

        });
        let $addBtn = $('#addBtn');
        let toggleEditModal = function (action, title) {
            $('#editTitle').html(title);
            $('#editModal').modal(action);
        };
        $addBtn.on("click", function () {
            toggleEditModal("show", $(this).html());
        });

    });
</script>
</body>
</html>